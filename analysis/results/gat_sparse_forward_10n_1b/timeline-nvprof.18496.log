==18496== NVPROF is profiling process 18496, command: python train.py --epochs 200 --profile-epoch-list 100-110 --profile-batch-list 0 --sparse --prof-forward
==18496== Profiling application: python train.py --epochs 200 --profile-epoch-list 100-110 --profile-batch-list 0 --sparse --prof-forward
==18496== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   63.92%  211.07ms       180  1.1726ms  1.1447ms  1.2107ms  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::unary_transform_f<thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, thrust::cuda_cub::__transform::no_stencil_tag, idx_functor, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::unary_transform_f<thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, thrust::cuda_cub::__transform::no_stencil_tag, idx_functor, thrust::cuda_cub::__transform::always_true_predicate>, long>(thrust::device_ptr<long>, thrust::device_ptr<long>)
                   13.57%  44.818ms       360  124.50us  123.07us  131.68us  void kernelTransformReduceInnermostDimIndex<long, long, MaxValuePair<long, long>>(long*, long*, long*, unsigned int, unsigned int, thrust::pair<long, long>, long)
                    8.38%  27.670ms        90  307.44us  300.42us  322.56us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__copy_if::CopyIfAgent<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<float>, thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, NonZeroOp<float>, int, int*>, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<float>, thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, NonZeroOp<float>, int, int*, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long>(thrust::use_default, thrust::use_default, thrust::use_default, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, float, thrust::device_ptr<float>, long, thrust::device_ptr<long>)
                    2.30%  7.5847ms        90  84.274us  12.736us  99.777us  sgemm_32x32x32_NN
                    1.41%  4.6468ms       180  25.815us  22.752us  29.856us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::BlockSortAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>, thrust::detail::integral_constant<bool, bool=0>>, bool, thrust::device_ptr<long>, thrust::device_ptr<long>, long, long*, long*, ThrustLTOp<long>>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, long, ThrustLTOp<long>, bool, bool=1)
                    0.99%  3.2607ms       110  29.642us  3.5840us  287.49us  generate_bernoulli(curandStateMtgp32*, int, float*, double)
                    0.87%  2.8779ms       180  15.988us  15.521us  17.056us  void csrMmt_hyb_core<float, int=3, int=5>(float, float, float const *, float const *, float const *, int const *, int const *, float const *, float*, int, int, int, int, int, int, bool)
                    0.84%  2.7711ms       540  5.1310us  3.6800us  9.6960us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>, bool, thrust::device_ptr<long>, thrust::device_ptr<long>, long, long*, long*, ThrustLTOp<long>, long*, long>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, long, ThrustLTOp<long>, bool, bool=1, thrust::detail::integral_constant<bool, bool=1>, thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>)
                    0.81%  2.6787ms       180  14.881us  14.528us  15.936us  void at::native::apply::coalesceValuesKernel<float, float>(long*, at::native::apply::coalesceValuesKernel<float, float>, float*, float, long, long, long)
                    0.74%  2.4540ms       110  22.309us  1.1200us  229.44us  void kernelPointwiseApply2<TensorMulOp<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.53%  1.7425ms       540  3.2260us  3.0080us  4.0960us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::PartitionAgent<thrust::device_ptr<long>, long, ThrustLTOp<long>>, bool, thrust::device_ptr<long>, long*, long, unsigned long, long*, ThrustLTOp<long>, long, int>(thrust::device_ptr<long>, long, long, ThrustLTOp<long>, thrust::cuda_cub::__merge_sort::PartitionAgent<thrust::device_ptr<long>, long, ThrustLTOp<long>>, bool, thrust::device_ptr<long>, long*, long)
                    0.51%  1.6987ms       110  15.442us  1.0560us  158.79us  void kernelPointwiseApply1<TensorDivConstantOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorDivConstantOp<float>, float, unsigned int>, float, float)
                    0.40%  1.3253ms      2070     640ns     576ns  1.0240us  [CUDA memcpy DtoH]
                    0.40%  1.3062ms       360  3.6280us  3.0720us  4.0640us  void kernelReduceAllPass1<unsigned char, unsigned int, unsigned char, thrust::identity<unsigned char>, LogicalAny, int=1>(TensorInfo<unsigned char, unsigned int>, unsigned int, unsigned char, unsigned char, thrust::identity<unsigned char>, unsigned char*)
                    0.30%  1.0044ms        90  11.160us  11.008us  11.744us  void gemv2T_kernel_val<float, float, float, int=128, int=16, int=2, int=4, bool=0>(int, int, float, float const *, int, float const *, int, float, float*, int)
                    0.28%  928.91us       180  5.1600us  3.1360us  5.8560us  void kernelPointwiseApply3<TensorAddOp<long>, long, long, long, unsigned int, int=1, int=2, int=2>(OffsetInfo<TensorAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, OffsetInfo<long, long, int=2>, long, long)
                    0.28%  916.87us       180  5.0930us  3.7440us  6.7200us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__unique_by_key::UniqueByKeyAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int, int*>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int*, int, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long>(thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, long, thrust::equal_to<long>, int, int*, thrust::cuda_cub::__unique_by_key::UniqueByKeyAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int, int*>)
                    0.27%  891.94us       100  8.9190us  7.7120us  12.768us  void CatArrayBatchedCopy<float, unsigned int, int=2>(float*, CatArrInputTensor<float, unsigned int>*, OutputTensorSizeStride<unsigned int, unsigned int=4>, int, unsigned int)
                    0.27%  890.09us       360  2.4720us  1.7600us  3.2320us  void kernelReduceAllPass2<unsigned char, LogicalAny>(int, unsigned char, LogicalAny, unsigned char*, unsigned char*)
                    0.21%  679.24us       180  3.7730us  2.8800us  4.9600us  void kernelReduceAllPass1<long, unsigned int, long, thrust::identity<long>, ReduceMax<long>, int=1>(TensorInfo<long, unsigned int>, unsigned int, long, long, thrust::identity<long>, long*)
                    0.20%  652.20us       540  1.2070us  1.0560us  1.5360us  void kernelPointwiseApply2<TensorCAddOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorCAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.19%  643.81us       650     990ns     448ns  2.9440us  [CUDA memcpy DtoD]
                    0.18%  596.32us       180  3.3120us  2.7840us  4.1280us  void kernelPointwiseApply2<TensorTakeOp<float, int, int=-2>, float, long, unsigned int, int=1, int=1>(OffsetInfo<int, TensorTakeOp<float, int, int=-2>, float>, OffsetInfo<int=-2, TensorTakeOp<float, int, int=-2>, long>, TensorTakeOp<float, int, int=-2>, float)
                    0.18%  589.00us       180  3.2720us  2.8160us  3.9040us  void kernelReduceAllPass1<long, unsigned int, long, thrust::identity<long>, ReduceMin<long>, int=1>(TensorInfo<long, unsigned int>, unsigned int, long, long, thrust::identity<long>, long*)
                    0.14%  468.97us       540     868ns     672ns  1.1520us  void kernelPointwiseApply1<TensorFillOp<long>, long, unsigned int, int=1>(OffsetInfo<TensorFillOp<long>, long, unsigned int>, long, long)
                    0.14%  446.31us       180  2.4790us  1.7920us  3.2000us  void kernelReduceAllPass2<long, ReduceMax<long>>(int, long, long, long*, long*)
                    0.13%  436.10us       360  1.2110us  1.0880us  1.5040us  void kernelPointwiseApply1<TensorDivConstantOp<long>, long, unsigned int, int=1>(OffsetInfo<TensorDivConstantOp<long>, long, unsigned int>, long, long)
                    0.13%  424.58us       180  2.3580us  1.8240us  3.1040us  void kernelReduceAllPass2<long, ReduceMin<long>>(int, long, long, long*, long*)
                    0.13%  420.74us       360  1.1680us     960ns  1.7280us  void kernelPointwiseApply3<TensorNEOp<float, unsigned char>, unsigned char, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<unsigned char, float, float>, OffsetInfo<TensorNEOp<float, unsigned char>, float, unsigned int>, OffsetInfo<unsigned char, float, int=1>, float, float)
                    0.11%  370.31us       180  2.0570us  1.8240us  2.5280us  void convert_CooToCsr_kernel<int=0>(int const *, int, int, int*)
                    0.11%  365.60us       360  1.0150us     896ns  1.2800us  void kernelPointwiseApply2<CopyOp<int, long>, int, long, unsigned int, int=1, int=1>(OffsetInfo<long, int, long>, OffsetInfo<CopyOp<int, long>, int, unsigned int>, int, int)
                    0.10%  337.92us       180  1.8770us  1.3440us  2.5920us  void kernelPointwiseApply2<CopyOp<long, long>, long, long, unsigned int, int=1, int=2>(OffsetInfo<long, long, long>, OffsetInfo<CopyOp<long, long>, long, unsigned int>, long, long)
                    0.10%  332.13us       360     922ns     704ns  1.1840us  void kernelPointwiseApply1<TensorFillOp<unsigned char>, unsigned char, unsigned int, int=1>(OffsetInfo<TensorFillOp<unsigned char>, unsigned char, unsigned int>, unsigned char, unsigned char)
                    0.10%  328.74us       360     913ns     768ns  1.2170us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>(thrust::use_default, thrust::use_default)
                    0.08%  253.12us       180  1.4060us  1.1840us  1.6640us  void kernelPointwiseApply2<TensorRemainderOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorRemainderOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.08%  249.47us       180  1.3850us  1.2800us  1.6000us  void kernelPointwiseApply2<TensorAddOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.08%  249.47us       180  1.3850us  1.0560us  1.8560us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=1, int=2>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.06%  205.67us       360     571ns     448ns     992ns  [CUDA memset]
                    0.06%  200.87us       180  1.1150us     896ns  1.3440us  void kernelPointwiseApply2<TensorMulConstantOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorMulConstantOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.06%  182.08us       180  1.0110us     768ns  1.3440us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__tabulate::functor<thrust::device_ptr<long>, LinspaceOp<long, long>, long>, long>, thrust::cuda_cub::__tabulate::functor<thrust::device_ptr<long>, LinspaceOp<long, long>, long>, long>(thrust::device_ptr<long>, long)
                    0.05%  178.91us        90  1.9870us  1.8880us  2.1440us  void kernelPointwiseApply3<TensorDivOp<float>, float, float, float, unsigned int, int=1, int=1, int=2>(OffsetInfo<TensorDivOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.05%  172.10us       180     956ns     800ns  1.1840us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__unique_by_key::InitAgent<thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*, int>, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long, int*>(bool=1, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*)
                    0.05%  170.69us       190     898ns     480ns  1.4080us  [CUDA memcpy HtoD]
                    0.04%  143.94us        10  14.393us  14.240us  14.848us  void at::native::_GLOBAL__N__54_tmpxft_0000343e_00000000_10_SoftMax_compute_70_cpp1_ii_826a4626::cunn_SoftMaxForward<int=2, float, float, at::native::_GLOBAL__N__54_tmpxft_0000343e_00000000_10_SoftMax_compute_70_cpp1_ii_826a4626::LogSoftMaxForwardEpilogue>(float*, float, int)
                    0.04%  138.31us        90  1.5360us  1.4080us  1.6320us  void kernelPointwiseApply2<ELUupdateOutput_functor<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<ELUupdateOutput_functor<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.04%  129.38us        90  1.4370us  1.3120us  1.6000us  void kernelPointwiseApply2<Tensor_exp_Float_Op, float, float, unsigned int, int=1, int=1>(OffsetInfo<float, unsigned int, int=1>, OffsetInfo<float, unsigned int, int=1>, unsigned int, Tensor_exp_Float_Op)
                    0.03%  101.95us        90  1.1320us  1.0880us  1.2480us  void kernelPointwiseApply2<LeakyReLUUpdateOutput<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<LeakyReLUUpdateOutput<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.03%  100.51us        90  1.1160us  1.0560us  1.2160us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__copy_if::InitAgent<thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*, int>, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long, int*>(bool=1, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*)
                    0.03%  100.32us        90  1.1140us  1.0560us  1.2480us  void kernelPointwiseApply2<Tensor_neg_Float_Op, float, float, unsigned int, int=1, int=1>(OffsetInfo<float, unsigned int, int=1>, OffsetInfo<float, unsigned int, int=1>, unsigned int, Tensor_neg_Float_Op)
      API calls:   94.59%  7.33556s      9710  755.46us  4.2520us  850.87ms  cudaLaunch
                    3.60%  279.11ms      2910  95.915us  6.4520us  2.4885ms  cudaMemcpyAsync
                    0.74%  57.528ms     91420     629ns     526ns  291.25us  cudaGetDevice
                    0.52%  40.473ms      2610  15.507us  1.5010us  788.85us  cudaStreamSynchronize
                    0.25%  19.591ms     30990     632ns     561ns  14.730us  cudaSetDevice
                    0.13%  10.286ms      1800  5.7140us  5.2810us  25.880us  cudaFuncGetAttributes
                    0.06%  4.8317ms     50970      94ns      69ns  18.218us  cudaSetupArgument
                    0.03%  2.0867ms       360  5.7960us  4.1220us  10.008us  cudaMemsetAsync
                    0.02%  1.5874ms      2700     587ns     523ns  1.2710us  cudaDeviceGetAttribute
                    0.02%  1.4710ms      9710     151ns      87ns  4.1380us  cudaConfigureCall
                    0.02%  1.4373ms     10810     132ns      70ns  4.4190us  cudaGetLastError
                    0.01%  507.82us      5040     100ns      67ns  4.0540us  cudaPeekAtLastError
                    0.00%  204.69us       100  2.0460us  1.8170us  2.9260us  cudaEventQuery
                    0.00%  158.19us       100  1.5810us  1.4350us  2.3530us  cudaEventCreateWithFlags
                    0.00%  155.03us       100  1.5500us  1.4580us  2.0170us  cudaEventRecord
                    0.00%  137.17us       100  1.3710us  1.2310us  2.1400us  cudaEventDestroy
==18496== Generated result file: /home/adam/school/research/gnn/gnn-research/pygat/profile/2019_03_08__18_29_06/train-timeline.18496.nvprof
