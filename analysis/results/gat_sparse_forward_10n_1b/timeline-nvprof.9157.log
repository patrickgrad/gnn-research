==9157== NVPROF is profiling process 9157, command: python train.py --epochs 200 --profile-epoch-list 100-110 --profile-batch-list 0 --sparse --prof-forward
==9157== Profiling application: python train.py --epochs 200 --profile-epoch-list 100-110 --profile-batch-list 0 --sparse --prof-forward
==9157== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   64.01%  220.30ms       180  1.2239ms  1.1453ms  1.8836ms  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::unary_transform_f<thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, thrust::cuda_cub::__transform::no_stencil_tag, idx_functor, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::unary_transform_f<thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, thrust::cuda_cub::__transform::no_stencil_tag, idx_functor, thrust::cuda_cub::__transform::always_true_predicate>, long>(thrust::device_ptr<long>, thrust::device_ptr<long>)
                   13.71%  47.187ms       360  131.07us  123.14us  731.62us  void kernelTransformReduceInnermostDimIndex<long, long, MaxValuePair<long, long>>(long*, long*, long*, unsigned int, unsigned int, thrust::pair<long, long>, long)
                    8.40%  28.906ms        90  321.18us  301.57us  553.41us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__copy_if::CopyIfAgent<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<float>, thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, NonZeroOp<float>, int, int*>, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<float>, thrust::permutation_iterator<thrust::device_ptr<long>, thrust::transform_iterator<strided_range<thrust::device_ptr<long>>::stride_functor, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::use_default, thrust::use_default>>, NonZeroOp<float>, int, int*, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long>(thrust::use_default, thrust::use_default, thrust::use_default, thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, float, thrust::device_ptr<float>, long, thrust::device_ptr<long>)
                    2.20%  7.5711ms        90  84.122us  12.864us  96.769us  sgemm_32x32x32_NN
                    1.38%  4.7464ms       180  26.368us  22.752us  29.952us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::BlockSortAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>, thrust::detail::integral_constant<bool, bool=0>>, bool, thrust::device_ptr<long>, thrust::device_ptr<long>, long, long*, long*, ThrustLTOp<long>>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, long, ThrustLTOp<long>, bool, bool=1)
                    0.97%  3.3512ms       540  6.2050us  3.7120us  502.15us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>, bool, thrust::device_ptr<long>, thrust::device_ptr<long>, long, long*, long*, ThrustLTOp<long>, long*, long>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, long, ThrustLTOp<long>, bool, bool=1, thrust::detail::integral_constant<bool, bool=1>, thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>)
                    0.95%  3.2787ms       110  29.806us  3.5840us  284.96us  generate_bernoulli(curandStateMtgp32*, int, float*, double)
                    0.85%  2.9158ms       180  16.199us  15.584us  19.552us  void csrMmt_hyb_core<float, int=3, int=5>(float, float, float const *, float const *, float const *, int const *, int const *, float const *, float*, int, int, int, int, int, int, bool)
                    0.79%  2.7107ms       180  15.059us  14.496us  17.536us  void at::native::apply::coalesceValuesKernel<float, float>(long*, at::native::apply::coalesceValuesKernel<float, float>, float*, float, long, long, long)
                    0.71%  2.4490ms       110  22.263us  1.1200us  234.31us  void kernelPointwiseApply2<TensorMulOp<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.52%  1.7802ms       540  3.2960us  3.0080us  7.1360us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::PartitionAgent<thrust::device_ptr<long>, long, ThrustLTOp<long>>, bool, thrust::device_ptr<long>, long*, long, unsigned long, long*, ThrustLTOp<long>, long, int>(thrust::device_ptr<long>, long, long, ThrustLTOp<long>, thrust::cuda_cub::__merge_sort::PartitionAgent<thrust::device_ptr<long>, long, ThrustLTOp<long>>, bool, thrust::device_ptr<long>, long*, long)
                    0.50%  1.7055ms       110  15.504us  1.0560us  171.30us  void kernelPointwiseApply1<TensorDivConstantOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorDivConstantOp<float>, float, unsigned int>, float, float)
                    0.40%  1.3692ms      2070     661ns     576ns  5.7600us  [CUDA memcpy DtoH]
                    0.39%  1.3310ms       360  3.6970us  3.1040us  7.0400us  void kernelReduceAllPass1<unsigned char, unsigned int, unsigned char, thrust::identity<unsigned char>, LogicalAny, int=1>(TensorInfo<unsigned char, unsigned int>, unsigned int, unsigned char, unsigned char, thrust::identity<unsigned char>, unsigned char*)
                    0.29%  1.0020ms        90  11.133us  10.944us  11.712us  void gemv2T_kernel_val<float, float, float, int=128, int=16, int=2, int=4, bool=0>(int, int, float, float const *, int, float const *, int, float, float*, int)
                    0.28%  949.45us       180  5.2740us  3.7760us  7.3280us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__unique_by_key::UniqueByKeyAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int, int*>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int*, int, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long>(thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, long, thrust::equal_to<long>, int, int*, thrust::cuda_cub::__unique_by_key::UniqueByKeyAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int, int*>)
                    0.27%  922.03us       180  5.1220us  3.0400us  5.7920us  void kernelPointwiseApply3<TensorAddOp<long>, long, long, long, unsigned int, int=1, int=2, int=2>(OffsetInfo<TensorAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, OffsetInfo<long, long, int=2>, long, long)
                    0.26%  909.13us       360  2.5250us  1.7280us  3.3280us  void kernelReduceAllPass2<unsigned char, LogicalAny>(int, unsigned char, LogicalAny, unsigned char*, unsigned char*)
                    0.26%  898.12us       100  8.9810us  7.3600us  12.385us  void CatArrayBatchedCopy<float, unsigned int, int=2>(float*, CatArrInputTensor<float, unsigned int>*, OutputTensorSizeStride<unsigned int, unsigned int=4>, int, unsigned int)
                    0.19%  670.95us       180  3.7270us  2.8160us  5.2160us  void kernelReduceAllPass1<long, unsigned int, long, thrust::identity<long>, ReduceMax<long>, int=1>(TensorInfo<long, unsigned int>, unsigned int, long, long, thrust::identity<long>, long*)
                    0.19%  666.99us       540  1.2350us  1.0560us  5.7600us  void kernelPointwiseApply2<TensorCAddOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorCAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.19%  653.57us       650  1.0050us     448ns  3.5840us  [CUDA memcpy DtoD]
                    0.18%  620.07us       180  3.4440us  2.9440us  4.6400us  void kernelPointwiseApply2<TensorTakeOp<float, int, int=-2>, float, long, unsigned int, int=1, int=1>(OffsetInfo<int, TensorTakeOp<float, int, int=-2>, float>, OffsetInfo<int=-2, TensorTakeOp<float, int, int=-2>, long>, TensorTakeOp<float, int, int=-2>, float)
                    0.18%  612.93us       180  3.4050us  2.8800us  4.6080us  void kernelReduceAllPass1<long, unsigned int, long, thrust::identity<long>, ReduceMin<long>, int=1>(TensorInfo<long, unsigned int>, unsigned int, long, long, thrust::identity<long>, long*)
                    0.14%  487.68us       540     903ns     672ns  7.1680us  void kernelPointwiseApply1<TensorFillOp<long>, long, unsigned int, int=1>(OffsetInfo<TensorFillOp<long>, long, unsigned int>, long, long)
                    0.14%  475.50us       180  2.6410us  1.7920us  3.4240us  void kernelReduceAllPass2<long, ReduceMax<long>>(int, long, long, long*, long*)
                    0.13%  440.33us       360  1.2230us  1.0880us  1.5040us  void kernelPointwiseApply1<TensorDivConstantOp<long>, long, unsigned int, int=1>(OffsetInfo<TensorDivConstantOp<long>, long, unsigned int>, long, long)
                    0.13%  437.57us       360  1.2150us     928ns  1.8560us  void kernelPointwiseApply3<TensorNEOp<float, unsigned char>, unsigned char, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<unsigned char, float, float>, OffsetInfo<TensorNEOp<float, unsigned char>, float, unsigned int>, OffsetInfo<unsigned char, float, int=1>, float, float)
                    0.13%  432.10us       180  2.4000us  1.7600us  3.9680us  void kernelReduceAllPass2<long, ReduceMin<long>>(int, long, long, long*, long*)
                    0.11%  382.24us       180  2.1230us  1.8240us  2.4970us  void convert_CooToCsr_kernel<int=0>(int const *, int, int, int*)
                    0.11%  371.20us       360  1.0310us     896ns  3.7770us  void kernelPointwiseApply2<CopyOp<int, long>, int, long, unsigned int, int=1, int=1>(OffsetInfo<long, int, long>, OffsetInfo<CopyOp<int, long>, int, unsigned int>, int, int)
                    0.10%  348.35us       180  1.9350us  1.3440us  3.0720us  void kernelPointwiseApply2<CopyOp<long, long>, long, long, unsigned int, int=1, int=2>(OffsetInfo<long, long, long>, OffsetInfo<CopyOp<long, long>, long, unsigned int>, long, long)
                    0.10%  339.91us       360     944ns     704ns  1.8560us  void kernelPointwiseApply1<TensorFillOp<unsigned char>, unsigned char, unsigned int, int=1>(OffsetInfo<TensorFillOp<unsigned char>, unsigned char, unsigned int>, unsigned char, unsigned char)
                    0.09%  326.05us       360     905ns     768ns  1.8240us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>(thrust::use_default, thrust::use_default)
                    0.08%  261.12us       180  1.4500us  1.0560us  7.2320us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=1, int=2>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.08%  258.63us       180  1.4360us  1.2800us  3.5840us  void kernelPointwiseApply2<TensorAddOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.07%  256.55us       180  1.4250us  1.1840us  2.9120us  void kernelPointwiseApply2<TensorRemainderOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorRemainderOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.06%  206.12us       360     572ns     448ns  1.2160us  [CUDA memset]
                    0.06%  202.40us       180  1.1240us     896ns  1.4080us  void kernelPointwiseApply2<TensorMulConstantOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorMulConstantOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.05%  181.25us       180  1.0060us     800ns  6.6560us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__unique_by_key::InitAgent<thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*, int>, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long, int*>(bool=1, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*)
                    0.05%  178.91us       180     993ns     768ns  1.9840us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__tabulate::functor<thrust::device_ptr<long>, LinspaceOp<long, long>, long>, long>, thrust::cuda_cub::__tabulate::functor<thrust::device_ptr<long>, LinspaceOp<long, long>, long>, long>(thrust::device_ptr<long>, long)
                    0.05%  178.30us        90  1.9810us  1.8560us  2.8160us  void kernelPointwiseApply3<TensorDivOp<float>, float, float, float, unsigned int, int=1, int=1, int=2>(OffsetInfo<TensorDivOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.05%  174.40us       190     917ns     512ns  1.4400us  [CUDA memcpy HtoD]
                    0.04%  143.87us        10  14.387us  14.176us  14.592us  void at::native::_GLOBAL__N__54_tmpxft_0000343e_00000000_10_SoftMax_compute_70_cpp1_ii_826a4626::cunn_SoftMaxForward<int=2, float, float, at::native::_GLOBAL__N__54_tmpxft_0000343e_00000000_10_SoftMax_compute_70_cpp1_ii_826a4626::LogSoftMaxForwardEpilogue>(float*, float, int)
                    0.04%  139.91us        90  1.5540us  1.4400us  1.8240us  void kernelPointwiseApply2<ELUupdateOutput_functor<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<ELUupdateOutput_functor<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.04%  132.74us        90  1.4740us  1.3440us  2.2080us  void kernelPointwiseApply2<Tensor_exp_Float_Op, float, float, unsigned int, int=1, int=1>(OffsetInfo<float, unsigned int, int=1>, OffsetInfo<float, unsigned int, int=1>, unsigned int, Tensor_exp_Float_Op)
                    0.03%  105.70us        90  1.1740us  1.0880us  5.7920us  void kernelPointwiseApply2<Tensor_neg_Float_Op, float, float, unsigned int, int=1, int=1>(OffsetInfo<float, unsigned int, int=1>, OffsetInfo<float, unsigned int, int=1>, unsigned int, Tensor_neg_Float_Op)
                    0.03%  102.24us        90  1.1360us  1.0560us  1.8240us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__copy_if::InitAgent<thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*, int>, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long, int*>(bool=1, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*)
                    0.03%  100.16us        90  1.1120us  1.0560us  1.2160us  void kernelPointwiseApply2<LeakyReLUUpdateOutput<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<LeakyReLUUpdateOutput<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
      API calls:   94.48%  7.64246s      9710  787.07us  4.0000us  912.21ms  cudaLaunch
                    3.69%  298.65ms      2910  102.63us  6.2520us  3.0315ms  cudaMemcpyAsync
                    0.72%  58.517ms     91420     640ns     527ns  309.89us  cudaGetDevice
                    0.58%  46.763ms      2610  17.916us  1.4160us  933.59us  cudaStreamSynchronize
                    0.24%  19.357ms     30990     624ns     544ns  15.509us  cudaSetDevice
                    0.13%  10.343ms      1800  5.7460us  5.2540us  19.468us  cudaFuncGetAttributes
                    0.06%  4.9595ms     50970      97ns      68ns  10.421us  cudaSetupArgument
                    0.03%  2.4133ms       360  6.7030us  4.0630us  356.68us  cudaMemsetAsync
                    0.02%  1.6614ms      2700     615ns     523ns  11.413us  cudaDeviceGetAttribute
                    0.02%  1.5318ms      9710     157ns      86ns  10.419us  cudaConfigureCall
                    0.02%  1.4915ms     10810     137ns      75ns  10.476us  cudaGetLastError
                    0.01%  552.69us      5040     109ns      67ns  10.447us  cudaPeekAtLastError
                    0.00%  209.67us       100  2.0960us  1.9140us  2.7870us  cudaEventQuery
                    0.00%  155.66us       100  1.5560us  1.4400us  2.1800us  cudaEventRecord
                    0.00%  155.34us       100  1.5530us  1.3820us  2.1700us  cudaEventCreateWithFlags
                    0.00%  133.76us       100  1.3370us  1.1480us  2.0680us  cudaEventDestroy
==9157== Generated result file: /home/adam/school/research/gnn/gnn-research/pygat/profile/2019_03_05__17_00_29/train-timeline.9157.nvprof
