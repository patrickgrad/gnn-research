==26334== NVPROF is profiling process 26334, command: python train.py --dataset reddit --epochs 1 --prof-backprop
==26334== Profiling application: python train.py --dataset reddit --epochs 1 --prof-backprop
==26334== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   70.52%  799.88ms         2  399.94ms  397.43ms  402.46ms  void kernelTransformReduceInnermostDimIndex<long, long, MaxValuePair<long, long>>(long*, long*, long*, unsigned int, unsigned int, thrust::pair<long, long>, long)
                    9.20%  104.32ms        28  3.7257ms  3.6809ms  3.7699ms  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>, bool, thrust::device_ptr<long>, thrust::device_ptr<long>, long, long*, long*, ThrustLTOp<long>, long*, long>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, long, ThrustLTOp<long>, bool, bool=1, thrust::detail::integral_constant<bool, bool=1>, thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>)
                    5.08%  57.651ms         2  28.825ms  28.763ms  28.887ms  void at::native::apply::coalesceValuesKernel<float, float>(long*, at::native::apply::coalesceValuesKernel<float, float>, float*, float, long, long, long)
                    2.55%  28.893ms        19  1.5207ms     864ns  3.8131ms  [CUDA memcpy DtoD]
                    2.51%  28.488ms         1  28.488ms  28.488ms  28.488ms  void csrMmt_hyb_core<float, int=3, int=5>(float, float, float const *, float const *, float const *, int const *, int const *, float const *, float*, int, int, int, int, int, int, bool)
                    1.98%  22.510ms         2  11.255ms  11.115ms  11.395ms  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::BlockSortAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>, thrust::detail::integral_constant<bool, bool=0>>, bool, thrust::device_ptr<long>, thrust::device_ptr<long>, long, long*, long*, ThrustLTOp<long>>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, long, ThrustLTOp<long>, bool, bool=1)
                    1.62%  18.415ms         1  18.415ms  18.415ms  18.415ms  void csrMmt_hyb_core<float, int=5, int=3>(float, float, float const *, float const *, float const *, int const *, int const *, float const *, float*, int, int, int, int, int, int, bool)
                    1.45%  16.426ms         6  2.7376ms  2.7076ms  2.7576ms  void kernelPointwiseApply2<TensorCAddOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorCAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    1.11%  12.614ms         1  12.614ms  12.614ms  12.614ms  void csrMmt_hyb_core<float, int=4, int=4>(float, float, float const *, float const *, float const *, int const *, int const *, float const *, float*, int, int, int, int, int, int, bool)
                    0.67%  7.5750ms         4  1.8938ms  1.8699ms  1.9188ms  void kernelPointwiseApply1<TensorDivConstantOp<long>, long, unsigned int, int=1>(OffsetInfo<TensorDivConstantOp<long>, long, unsigned int>, long, long)
                    0.66%  7.5221ms         2  3.7611ms  3.7540ms  3.7682ms  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__unique_by_key::UniqueByKeyAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int, int*>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int*, int, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long>(thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, long, thrust::equal_to<long>, int, int*, thrust::cuda_cub::__unique_by_key::UniqueByKeyAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int, int*>)
                    0.48%  5.4595ms         4  1.3649ms  1.3541ms  1.3843ms  void kernelPointwiseApply2<CopyOp<int, long>, int, long, unsigned int, int=1, int=1>(OffsetInfo<long, int, long>, OffsetInfo<CopyOp<int, long>, int, unsigned int>, int, int)
                    0.48%  5.4305ms         2  2.7152ms  2.7120ms  2.7185ms  void kernelPointwiseApply2<TensorAddOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.31%  3.5454ms         4  886.35us  851.08us  926.22us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>(thrust::use_default, thrust::use_default)
                    0.31%  3.4820ms         1  3.4820ms  3.4820ms  3.4820ms  sgemm_32x32x32_TN
                    0.26%  2.9108ms        36  80.854us  5.6640us  135.14us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::PartitionAgent<thrust::device_ptr<long>, long, ThrustLTOp<long>>, bool, thrust::device_ptr<long>, long*, long, unsigned long, long*, ThrustLTOp<long>, long, int>(thrust::device_ptr<long>, long, long, ThrustLTOp<long>, thrust::cuda_cub::__merge_sort::PartitionAgent<thrust::device_ptr<long>, long, ThrustLTOp<long>>, bool, thrust::device_ptr<long>, long*, long)
                    0.25%  2.8667ms         4  716.67us  152.45us  1.6648ms  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=1, int=2>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.16%  1.7973ms         2  898.65us  871.91us  925.38us  void kernelPointwiseApply1<TensorFillOp<long>, long, unsigned int, int=1>(OffsetInfo<TensorFillOp<long>, long, unsigned int>, long, long)
                    0.09%  1.0117ms         2  505.84us  504.71us  506.98us  void convert_CooToCsr_kernel<int=0>(int const *, int, int, int*)
                    0.08%  892.62us         1  892.62us  892.62us  892.62us  void at::native::_GLOBAL__N__54_tmpxft_0000343e_00000000_10_SoftMax_compute_70_cpp1_ii_826a4626::cunn_SoftMaxBackward<int=2, float, float, at::native::_GLOBAL__N__54_tmpxft_0000343e_00000000_10_SoftMax_compute_70_cpp1_ii_826a4626::LogSoftMaxBackwardEpilogue>(float*, float, float, int)
                    0.04%  481.16us         8  60.144us  55.744us  65.985us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<float>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>, bool, thrust::device_ptr<long>, thrust::device_ptr<float>, long, long*, float*, ThrustLTOp<long>, long*, long>(thrust::device_ptr<long>, float, thrust::device_ptr<float>, long, long, ThrustLTOp<long>, bool, bool=1, thrust::detail::integral_constant<bool, bool=1>)
                    0.04%  476.07us         1  476.07us  476.07us  476.07us  void sgemm_largek_lds64<bool=0, bool=1, int=5, int=5, int=4, int=4, int=4, int=32>(float*, float const *, float const *, int, int, int, int, int, int, float const *, float const *, float, float, int, int, int*, int*)
                    0.03%  389.64us         1  389.64us  389.64us  389.64us  sgemm_32x32x32_NT
                    0.03%  290.88us         2  145.44us  98.721us  192.16us  void kernelReduceNoncontigDim_shared<float, unsigned int, float, thrust::identity<float>, ReduceAdd<float>, thrust::identity<float>, int=1, int=1>(TensorInfo<float, unsigned int>, TensorInfo<float, unsigned int>, unsigned int, unsigned int, unsigned int, float, float, thrust::identity<float>, float, float volatile *, int*)
                    0.02%  220.16us         1  220.16us  220.16us  220.16us  void kernelPointwiseApply3<ThresholdUpdateGradInput<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<ThresholdUpdateGradInput<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.02%  214.85us         1  214.85us  214.85us  214.85us  void kernelPointwiseApply3<TensorMulOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.02%  210.37us         1  210.37us  210.37us  210.37us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::BlockSortAgent<thrust::device_ptr<long>, thrust::device_ptr<float>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>, thrust::detail::integral_constant<bool, bool=0>>, bool, thrust::device_ptr<long>, thrust::device_ptr<float>, long, long*, float*, ThrustLTOp<long>>(thrust::device_ptr<long>, float, thrust::device_ptr<float>, long, long, ThrustLTOp<long>, bool)
                    0.02%  170.27us         1  170.27us  170.27us  170.27us  void cunn_ClassNLLCriterion_updateGradInput_kernel<float>(float*, float*, long*, float*, float*, int, int, int, int, long)
                    0.00%  50.465us         1  50.465us  50.465us  50.465us  void kernelPointwiseApply2<TensorPutAccumulateOp<float, int, int=-2>, float, long, unsigned int, int=1, int=1>(OffsetInfo<int, TensorPutAccumulateOp<float, int, int=-2>, float>, OffsetInfo<int=-2, TensorPutAccumulateOp<float, int, int=-2>, long>, TensorPutAccumulateOp<float, int, int=-2>, float)
                    0.00%  38.624us         1  38.624us  38.624us  38.624us  void kernelPointwiseApply2<WrapIndexOp, long, long, unsigned int, int=1, int=1>(OffsetInfo<long, unsigned int, int=1>, OffsetInfo<long, unsigned int, int=1>, unsigned int, WrapIndexOp)
                    0.00%  5.8240us        10     582ns     448ns     864ns  [CUDA memset]
                    0.00%  5.0560us         2  2.5280us  1.8880us  3.1680us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__unique_by_key::InitAgent<thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*, int>, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long, int*>(bool=1, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*)
                    0.00%  4.3840us         4  1.0960us     928ns  1.4080us  [CUDA memcpy DtoH]
                    0.00%  2.8810us         1  2.8810us  2.8810us  2.8810us  [CUDA memcpy HtoD]
                    0.00%  2.0800us         1  2.0800us  2.0800us  2.0800us  void scal_kernel<float, float, int=1, bool=1, int=6, int=5, int=5, int=3>(cublasTransposeParams<float>, float const *, float*, float const *)
                    0.00%  1.7920us         1  1.7920us  1.7920us  1.7920us  void kernelPointwiseApply1<TensorFillOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorFillOp<float>, float, unsigned int>, float, float)
      API calls:   44.65%  883.65ms        24  36.819ms  9.9140us  444.14ms  cudaMemcpyAsync
                   43.82%  867.12ms       127  6.8277ms  5.0530us  866.10ms  cudaLaunch
                   11.41%  225.81ms         9  25.090ms  1.7810us  134.03ms  cudaStreamSynchronize
                    0.04%  755.25us       786     960ns     531ns  221.01us  cudaGetDevice
                    0.03%  674.03us         2  337.02us  300.21us  373.82us  cudaMalloc
                    0.02%  433.49us       971     446ns      75ns  164.03us  cudaSetupArgument
                    0.01%  237.09us       332     714ns     548ns  3.9100us  cudaSetDevice
                    0.01%  110.26us        16  6.8910us  5.2700us  9.4710us  cudaFuncGetAttributes
                    0.00%  94.772us         9  10.530us  5.1570us  15.287us  cudaMemsetAsync
                    0.00%  25.699us       127     202ns     115ns  5.2220us  cudaConfigureCall
                    0.00%  24.178us       100     241ns      74ns  7.3410us  cudaGetLastError
                    0.00%  20.869us       166     125ns      76ns  1.4640us  cudaPeekAtLastError
                    0.00%  18.804us        27     696ns     531ns  1.2440us  cudaDeviceGetAttribute
                    0.00%  5.0780us         1  5.0780us  5.0780us  5.0780us  cudaEventQuery
                    0.00%  2.4720us         1  2.4720us  2.4720us  2.4720us  cudaEventRecord
                    0.00%     534ns         1     534ns     534ns     534ns  cudaGetDeviceCount
==26334== Generated result file: /home/adam/school/research/gnn/gnn-research/pygcn/pygcn/profile/2019_03_10__15_52_36/train-timeline.26334.nvprof
