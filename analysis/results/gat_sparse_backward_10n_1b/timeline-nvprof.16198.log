==16198== NVPROF is profiling process 16198, command: python train.py --epochs 200 --profile-epoch-list 100-110 --profile-batch-list 0 --sparse --prof-backprop
==16198== Profiling application: python train.py --epochs 200 --profile-epoch-list 100-110 --profile-batch-list 0 --sparse --prof-backprop
==16198== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   12.06%  12.916ms        90  143.51us  135.10us  195.36us  void gemmk1_kernel<float, int=256, int=5, bool=0, bool=0, bool=0, bool=0>(cublasGemmk1Params<float>, float const *, float const *, float*)
                   11.74%  12.566ms        80  157.08us  150.59us  168.67us  sgemm_128x128x8_NT_vec
                   10.65%  11.407ms        90  126.75us  126.21us  127.39us  void kernelTransformReduceInnermostDimIndex<long, long, MaxValuePair<long, long>>(long*, long*, long*, unsigned int, unsigned int, thrust::pair<long, long>, long)
                   10.12%  10.831ms       190  57.003us  24.672us  65.729us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::BlockSortAgent<thrust::device_ptr<long>, thrust::device_ptr<float>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>, thrust::detail::integral_constant<bool, bool=0>>, bool, thrust::device_ptr<long>, thrust::device_ptr<float>, long, long*, float*, ThrustLTOp<long>>(thrust::device_ptr<long>, float, thrust::device_ptr<float>, long, long, ThrustLTOp<long>, bool)
                    8.84%  9.4661ms      1080  8.7640us  5.9520us  14.592us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<float>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>, bool, thrust::device_ptr<long>, thrust::device_ptr<float>, long, long*, float*, ThrustLTOp<long>, long*, long>(thrust::device_ptr<long>, float, thrust::device_ptr<float>, long, long, ThrustLTOp<long>, bool, bool=1, thrust::detail::integral_constant<bool, bool=1>)
                    8.33%  8.9230ms       190  46.963us  1.6960us  50.337us  void kernelPointwiseApply2<TensorPutAccumulateOp<float, int, int=-2>, float, long, unsigned int, int=1, int=1>(OffsetInfo<int, TensorPutAccumulateOp<float, int, int=-2>, float>, OffsetInfo<int=-2, TensorPutAccumulateOp<float, int, int=-2>, long>, TensorPutAccumulateOp<float, int, int=-2>, float)
                    6.78%  7.2637ms        90  80.707us  32.224us  88.481us  sgemm_32x32x32_TN
                    4.80%  5.1361ms      1350  3.8040us  3.1040us  6.8800us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::PartitionAgent<thrust::device_ptr<long>, long, ThrustLTOp<long>>, bool, thrust::device_ptr<long>, long*, long, unsigned long, long*, ThrustLTOp<long>, long, int>(thrust::device_ptr<long>, long, long, ThrustLTOp<long>, thrust::cuda_cub::__merge_sort::PartitionAgent<thrust::device_ptr<long>, long, ThrustLTOp<long>>, bool, thrust::device_ptr<long>, long*, long)
                    4.32%  4.6239ms        90  51.376us  50.112us  52.608us  void gemv2N_kernel_val<float, float, float, int=128, int=32, int=4, int=4, int=1>(float, float, cublasGemv2Params_v2<float, float, float>)
                    2.28%  2.4388ms        90  27.097us  26.880us  27.488us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::BlockSortAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>, thrust::detail::integral_constant<bool, bool=0>>, bool, thrust::device_ptr<long>, thrust::device_ptr<long>, long, long*, long*, ThrustLTOp<long>>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, long, ThrustLTOp<long>, bool, bool=1)
                    1.60%  1.7163ms       270  6.3560us  4.0320us  9.7290us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>, bool, thrust::device_ptr<long>, thrust::device_ptr<long>, long, long*, long*, ThrustLTOp<long>, long*, long>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, long, ThrustLTOp<long>, bool, bool=1, thrust::detail::integral_constant<bool, bool=1>, thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>)
                    1.47%  1.5767ms        10  157.67us  153.54us  161.12us  sgemm_128x128x8_NT
                    1.42%  1.5173ms        90  16.858us  16.513us  17.152us  void csrMmt_hyb_core<float, int=3, int=5>(float, float, float const *, float const *, float const *, int const *, int const *, float const *, float*, int, int, int, int, int, int, bool)
                    1.35%  1.4453ms       180  8.0290us  7.5520us  8.8640us  void kernelPointwiseApply2<TensorTakeOp<float, int, int=-2>, float, long, unsigned int, int=1, int=1>(OffsetInfo<int, TensorTakeOp<float, int, int=-2>, float>, OffsetInfo<int=-2, TensorTakeOp<float, int, int=-2>, long>, TensorTakeOp<float, int, int=-2>, float)
                    1.32%  1.4090ms       190  7.4150us  1.2800us  9.0240us  void kernelPointwiseApply2<WrapIndexOp, long, long, unsigned int, int=1, int=1>(OffsetInfo<long, unsigned int, int=1>, OffsetInfo<long, unsigned int, int=1>, unsigned int, WrapIndexOp)
                    1.27%  1.3650ms        90  15.166us  15.072us  15.297us  void at::native::apply::coalesceValuesKernel<float, float>(long*, at::native::apply::coalesceValuesKernel<float, float>, float*, float, long, long, long)
                    1.12%  1.2000ms       360  3.3330us  1.0880us  6.7520us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=1, int=2>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.65%  692.71us       180  3.8480us  3.6480us  4.0640us  void kernelReduceAllPass1<long, unsigned int, long, thrust::identity<long>, ReduceMax<long>, int=1>(TensorInfo<long, unsigned int>, unsigned int, long, long, thrust::identity<long>, long*)
                    0.64%  680.17us        90  7.5570us  7.4250us  7.6800us  void kernelReduceContigDim<float, unsigned int, float, thrust::identity<float>, ReduceAdd<float>, thrust::identity<float>, int=1, int=1>(TensorInfo<float, unsigned int>, TensorInfo<float, unsigned int>, unsigned int, unsigned int, float, float, thrust::identity<float>, float)
                    0.62%  666.37us       180  3.7020us  3.6160us  3.8730us  void kernelReduceAllPass1<long, unsigned int, long, thrust::identity<long>, ReduceMin<long>, int=1>(TensorInfo<long, unsigned int>, unsigned int, long, long, thrust::identity<long>, long*)
                    0.62%  661.10us       360  1.8360us     960ns  3.3280us  void kernelPointwiseApply2<TensorMulConstantOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorMulConstantOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.56%  604.45us       900     671ns     576ns  7.4560us  [CUDA memcpy DtoH]
                    0.55%  593.93us       550  1.0790us     928ns  1.6960us  [CUDA memcpy DtoD]
                    0.55%  588.77us        90  6.5410us  6.2720us  6.9760us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__unique_by_key::UniqueByKeyAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int, int*>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int*, int, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long>(thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, long, thrust::equal_to<long>, int, int*, thrust::cuda_cub::__unique_by_key::UniqueByKeyAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int, int*>)
                    0.51%  544.49us       180  3.0240us  2.8480us  3.3600us  void kernelReduceAllPass2<long, ReduceMax<long>>(int, long, long, long*, long*)
                    0.47%  502.31us       280  1.7930us  1.4080us  8.0960us  void kernelPointwiseApply3<TensorMulOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.45%  479.01us       180  2.6610us  2.4960us  2.8810us  void kernelReduceAllPass2<long, ReduceMin<long>>(int, long, long, long*, long*)
                    0.41%  444.16us       270  1.6450us  1.4080us  1.9520us  void kernelPointwiseApply3<TensorAddOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.41%  438.69us        90  4.8740us  4.6720us  5.1200us  void gemmk1_kernel<float, int=256, int=5, bool=0, bool=0, bool=1, bool=0>(cublasGemmk1Params<float>, float const *, float const *, float*)
                    0.39%  422.31us       450     938ns     672ns  1.3440us  void kernelPointwiseApply1<TensorFillOp<long>, long, unsigned int, int=1>(OffsetInfo<TensorFillOp<long>, long, unsigned int>, long, long)
                    0.31%  331.33us       270  1.2270us  1.0880us  1.4400us  void kernelPointwiseApply2<TensorCAddOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorCAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.25%  272.39us       180  1.5130us  1.4400us  1.6320us  void kernelPointwiseApply2<TensorRemainderOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorRemainderOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.25%  269.03us       180  1.4940us  1.4400us  1.6000us  void kernelPointwiseApply3<TensorAddOp<long>, long, long, long, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, OffsetInfo<long, long, int=1>, long, long)
                    0.24%  258.56us       180  1.4360us  1.2480us  6.4320us  void kernelPointwiseApply2<TensorAddOp<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.23%  244.80us        90  2.7200us  2.4320us  6.4000us  void kernelPointwiseApply2<CopyOp<long, long>, long, long, unsigned int, int=1, int=2>(OffsetInfo<long, long, long>, OffsetInfo<CopyOp<long, long>, long, unsigned int>, long, long)
                    0.22%  236.45us       470     503ns     448ns  1.2480us  [CUDA memset]
                    0.21%  227.14us       180  1.2610us  1.1200us  1.5040us  void kernelPointwiseApply1<TensorDivConstantOp<long>, long, unsigned int, int=1>(OffsetInfo<TensorDivConstantOp<long>, long, unsigned int>, long, long)
                    0.19%  208.71us       180  1.1590us  1.0880us  1.3120us  void kernelPointwiseApply2<Tensor_neg_Float_Op, float, float, unsigned int, int=1, int=1>(OffsetInfo<float, unsigned int, int=1>, OffsetInfo<float, unsigned int, int=1>, unsigned int, Tensor_neg_Float_Op)
                    0.19%  198.12us        90  2.2010us  2.1120us  2.4640us  void convert_CooToCsr_kernel<int=0>(int const *, int, int, int*)
                    0.18%  191.46us        90  2.1270us  1.9840us  2.3360us  void kernelPointwiseApply3<TensorDivOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorDivOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.18%  188.90us       180  1.0490us     896ns  1.2800us  void kernelPointwiseApply2<CopyOp<int, long>, int, long, unsigned int, int=1, int=1>(OffsetInfo<long, int, long>, OffsetInfo<CopyOp<int, long>, int, unsigned int>, int, int)
                    0.18%  187.91us        90  2.0870us  1.8880us  2.2400us  void kernelPointwiseApply3<TensorDivOp<float>, float, float, float, unsigned int, int=1, int=1, int=2>(OffsetInfo<TensorDivOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.16%  176.61us       180     981ns     768ns  1.2800us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>(thrust::use_default, thrust::use_default)
                    0.16%  168.00us        80  2.1000us  1.6960us  2.3040us  void kernelPointwiseApply3<ELUupdateGradInput_functor<float>, float, float, float, unsigned int, int=1, int=1, int=2>(OffsetInfo<ELUupdateGradInput_functor<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.13%  140.32us        90  1.5590us  1.4720us  1.6960us  void kernelPointwiseApply3<TensorMulOp<float>, float, float, float, unsigned int, int=1, int=2, int=2>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=2>, float, float)
                    0.13%  134.75us        90  1.4970us  1.4080us  1.7600us  void kernelPointwiseApply3<LeakyReLUUpdateGradInput<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<LeakyReLUUpdateGradInput<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.11%  120.87us        90  1.3420us  1.3120us  1.4080us  void kernelPointwiseApply2<TensorAddOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.11%  119.43us        10  11.942us  11.744us  12.096us  sgemm_32x32x32_NT
                    0.10%  104.86us        10  10.486us  10.272us  10.912us  void at::native::_GLOBAL__N__54_tmpxft_0000343e_00000000_10_SoftMax_compute_70_cpp1_ii_826a4626::cunn_SoftMaxBackward<int=2, float, float, at::native::_GLOBAL__N__54_tmpxft_0000343e_00000000_10_SoftMax_compute_70_cpp1_ii_826a4626::LogSoftMaxBackwardEpilogue>(float*, float, float, int)
                    0.09%  97.921us        90  1.0880us  1.0560us  1.1840us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__unique_by_key::InitAgent<thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*, int>, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long, int*>(bool=1, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*)
                    0.05%  48.897us        10  4.8890us  4.6400us  5.3760us  void cunn_ClassNLLCriterion_updateGradInput_kernel<float>(float*, float*, long*, float*, float*, int, int, int, int, long)
                    0.01%  15.776us        10  1.5770us  1.5360us  1.6640us  void kernelPointwiseApply3<ELUupdateGradInput_functor<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<ELUupdateGradInput_functor<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.01%  11.616us        10  1.1610us  1.1200us  1.2160us  void kernelPointwiseApply1<TensorFillOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorFillOp<float>, float, unsigned int>, float, float)
      API calls:   98.24%  7.23734s      9260  781.57us  4.3060us  855.15ms  cudaLaunch
                    0.65%  47.992ms     75500     635ns     546ns  313.09us  cudaGetDevice
                    0.40%  29.363ms      1450  20.250us  5.9030us  134.63us  cudaMemcpyAsync
                    0.24%  17.821ms     28350     628ns     546ns  18.649us  cudaSetDevice
                    0.20%  14.690ms      1270  11.566us  1.5740us  72.292us  cudaStreamSynchronize
                    0.08%  5.8175ms      1010  5.7590us  5.2650us  14.397us  cudaFuncGetAttributes
                    0.08%  5.5380ms     56660      97ns      70ns  6.6420us  cudaSetupArgument
                    0.05%  3.9202ms       470  8.3400us  4.3710us  25.324us  cudaMemsetAsync
                    0.02%  1.3326ms      9260     143ns      88ns  10.939us  cudaConfigureCall
                    0.02%  1.1604ms      1940     598ns     528ns  8.9650us  cudaDeviceGetAttribute
                    0.01%  1.0679ms      8310     128ns      70ns  4.3800us  cudaGetLastError
                    0.01%  636.38us      6680      95ns      68ns     279ns  cudaPeekAtLastError
==16198== Generated result file: /home/adam/school/research/gnn/gnn-research/pygat/profile/2019_03_08__20_57_35/train-timeline.16198.nvprof
