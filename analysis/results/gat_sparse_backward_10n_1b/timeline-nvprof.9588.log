==9588== NVPROF is profiling process 9588, command: python train.py --epochs 200 --profile-epoch-list 100-110 --profile-batch-list 0 --sparse --prof-backprop
==9588== Profiling application: python train.py --epochs 200 --profile-epoch-list 100-110 --profile-batch-list 0 --sparse --prof-backprop
==9588== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   11.67%  12.752ms        90  141.69us  135.20us  174.88us  void gemmk1_kernel<float, int=256, int=5, bool=0, bool=0, bool=0, bool=0>(cublasGemmk1Params<float>, float const *, float const *, float*)
                   11.52%  12.586ms        80  157.33us  150.40us  199.94us  sgemm_128x128x8_NT_vec
                   10.43%  11.402ms        90  126.69us  126.18us  127.30us  void kernelTransformReduceInnermostDimIndex<long, long, MaxValuePair<long, long>>(long*, long*, long*, unsigned int, unsigned int, thrust::pair<long, long>, long)
                   10.02%  10.947ms       190  57.614us  24.897us  65.856us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::BlockSortAgent<thrust::device_ptr<long>, thrust::device_ptr<float>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>, thrust::detail::integral_constant<bool, bool=0>>, bool, thrust::device_ptr<long>, thrust::device_ptr<float>, long, long*, float*, ThrustLTOp<long>>(thrust::device_ptr<long>, float, thrust::device_ptr<float>, long, long, ThrustLTOp<long>, bool)
                    9.98%  10.901ms      1080  10.093us  6.0160us  612.65us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<float>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>, bool, thrust::device_ptr<long>, thrust::device_ptr<float>, long, long*, float*, ThrustLTOp<long>, long*, long>(thrust::device_ptr<long>, float, thrust::device_ptr<float>, long, long, ThrustLTOp<long>, bool, bool=1, thrust::detail::integral_constant<bool, bool=1>)
                    8.64%  9.4390ms       190  49.678us  1.7280us  588.87us  void kernelPointwiseApply2<TensorPutAccumulateOp<float, int, int=-2>, float, long, unsigned int, int=1, int=1>(OffsetInfo<int, TensorPutAccumulateOp<float, int, int=-2>, float>, OffsetInfo<int=-2, TensorPutAccumulateOp<float, int, int=-2>, long>, TensorPutAccumulateOp<float, int, int=-2>, float)
                    6.59%  7.2013ms        90  80.014us  32.480us  91.937us  sgemm_32x32x32_TN
                    4.82%  5.2703ms      1350  3.9030us  3.1040us  113.67us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::PartitionAgent<thrust::device_ptr<long>, long, ThrustLTOp<long>>, bool, thrust::device_ptr<long>, long*, long, unsigned long, long*, ThrustLTOp<long>, long, int>(thrust::device_ptr<long>, long, long, ThrustLTOp<long>, thrust::cuda_cub::__merge_sort::PartitionAgent<thrust::device_ptr<long>, long, ThrustLTOp<long>>, bool, thrust::device_ptr<long>, long*, long)
                    4.24%  4.6284ms        90  51.426us  49.633us  53.601us  void gemv2N_kernel_val<float, float, float, int=128, int=32, int=4, int=4, int=1>(float, float, cublasGemv2Params_v2<float, float, float>)
                    2.21%  2.4196ms        90  26.884us  26.560us  27.232us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::BlockSortAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>, thrust::detail::integral_constant<bool, bool=0>>, bool, thrust::device_ptr<long>, thrust::device_ptr<long>, long, long*, long*, ThrustLTOp<long>>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, long, ThrustLTOp<long>, bool, bool=1)
                    1.59%  1.7425ms        90  19.360us  16.672us  230.72us  void csrMmt_hyb_core<float, int=3, int=5>(float, float, float const *, float const *, float const *, int const *, int const *, float const *, float*, int, int, int, int, int, int, bool)
                    1.54%  1.6867ms       270  6.2470us  3.9680us  9.3120us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>, bool, thrust::device_ptr<long>, thrust::device_ptr<long>, long, long*, long*, ThrustLTOp<long>, long*, long>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, long, ThrustLTOp<long>, bool, bool=1, thrust::detail::integral_constant<bool, bool=1>, thrust::cuda_cub::__merge_sort::MergeAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long>, thrust::detail::integral_constant<bool, bool=1>>)
                    1.44%  1.5789ms        10  157.89us  152.23us  164.00us  sgemm_128x128x8_NT
                    1.32%  1.4413ms       180  8.0070us  7.5850us  8.8640us  void kernelPointwiseApply2<TensorTakeOp<float, int, int=-2>, float, long, unsigned int, int=1, int=1>(OffsetInfo<int, TensorTakeOp<float, int, int=-2>, float>, OffsetInfo<int=-2, TensorTakeOp<float, int, int=-2>, long>, TensorTakeOp<float, int, int=-2>, float)
                    1.30%  1.4252ms       190  7.5010us  1.3440us  8.9600us  void kernelPointwiseApply2<WrapIndexOp, long, long, unsigned int, int=1, int=1>(OffsetInfo<long, unsigned int, int=1>, OffsetInfo<long, unsigned int, int=1>, unsigned int, WrapIndexOp)
                    1.28%  1.3972ms        90  15.524us  15.392us  16.097us  void at::native::apply::coalesceValuesKernel<float, float>(long*, at::native::apply::coalesceValuesKernel<float, float>, float*, float, long, long, long)
                    1.10%  1.1999ms       360  3.3330us  1.0240us  6.7840us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=1, int=2>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.64%  700.90us       180  3.8930us  3.6480us  5.9840us  void kernelReduceAllPass1<long, unsigned int, long, thrust::identity<long>, ReduceMax<long>, int=1>(TensorInfo<long, unsigned int>, unsigned int, long, long, thrust::identity<long>, long*)
                    0.63%  685.77us        90  7.6190us  7.4880us  7.8080us  void kernelReduceContigDim<float, unsigned int, float, thrust::identity<float>, ReduceAdd<float>, thrust::identity<float>, int=1, int=1>(TensorInfo<float, unsigned int>, TensorInfo<float, unsigned int>, unsigned int, unsigned int, float, float, thrust::identity<float>, float)
                    0.62%  679.18us       360  1.8860us     928ns  7.1040us  void kernelPointwiseApply2<TensorMulConstantOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorMulConstantOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.61%  665.86us       180  3.6990us  3.5520us  6.6560us  void kernelReduceAllPass1<long, unsigned int, long, thrust::identity<long>, ReduceMin<long>, int=1>(TensorInfo<long, unsigned int>, unsigned int, long, long, thrust::identity<long>, long*)
                    0.56%  613.51us       900     681ns     576ns  6.4640us  [CUDA memcpy DtoH]
                    0.54%  595.31us       550  1.0820us     928ns  1.6960us  [CUDA memcpy DtoD]
                    0.52%  564.36us        90  6.2700us  5.9200us  6.6560us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__unique_by_key::UniqueByKeyAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int, int*>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int*, int, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long>(thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, long, thrust::equal_to<long>, int, int*, thrust::cuda_cub::__unique_by_key::UniqueByKeyAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::equal_to<long>, int, int*>)
                    0.45%  494.28us       180  2.7450us  2.5600us  4.0960us  void kernelReduceAllPass2<long, ReduceMax<long>>(int, long, long, long*, long*)
                    0.44%  486.12us       280  1.7360us  1.1840us  7.8400us  void kernelPointwiseApply3<TensorMulOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.44%  484.07us       180  2.6890us  2.4960us  7.8400us  void kernelReduceAllPass2<long, ReduceMin<long>>(int, long, long, long*, long*)
                    0.41%  444.87us        90  4.9430us  4.6400us  5.2480us  void gemmk1_kernel<float, int=256, int=5, bool=0, bool=0, bool=1, bool=0>(cublasGemmk1Params<float>, float const *, float const *, float*)
                    0.40%  440.42us       270  1.6310us  1.4080us  2.8160us  void kernelPointwiseApply3<TensorAddOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.37%  408.58us       450     907ns     672ns  2.1440us  void kernelPointwiseApply1<TensorFillOp<long>, long, unsigned int, int=1>(OffsetInfo<TensorFillOp<long>, long, unsigned int>, long, long)
                    0.31%  335.14us       270  1.2410us  1.0560us  6.4970us  void kernelPointwiseApply2<TensorCAddOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorCAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.24%  267.33us       180  1.4850us  1.4080us  3.5840us  void kernelPointwiseApply2<TensorRemainderOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorRemainderOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.24%  264.45us       180  1.4690us  1.4080us  1.6960us  void kernelPointwiseApply3<TensorAddOp<long>, long, long, long, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, OffsetInfo<long, long, int=1>, long, long)
                    0.23%  253.28us       180  1.4070us  1.2160us  4.3840us  void kernelPointwiseApply2<TensorAddOp<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.23%  248.99us       470     529ns     448ns  6.4640us  [CUDA memset]
                    0.22%  245.28us        90  2.7250us  2.4640us  2.9440us  void kernelPointwiseApply2<CopyOp<long, long>, long, long, unsigned int, int=1, int=2>(OffsetInfo<long, long, long>, OffsetInfo<CopyOp<long, long>, long, unsigned int>, long, long)
                    0.22%  236.64us       180  1.3140us  1.1200us  7.0400us  void kernelPointwiseApply1<TensorDivConstantOp<long>, long, unsigned int, int=1>(OffsetInfo<TensorDivConstantOp<long>, long, unsigned int>, long, long)
                    0.20%  213.12us       180  1.1840us  1.1200us  1.6320us  void kernelPointwiseApply2<Tensor_neg_Float_Op, float, float, unsigned int, int=1, int=1>(OffsetInfo<float, unsigned int, int=1>, OffsetInfo<float, unsigned int, int=1>, unsigned int, Tensor_neg_Float_Op)
                    0.19%  210.92us        90  2.3430us  2.2400us  2.6240us  void convert_CooToCsr_kernel<int=0>(int const *, int, int, int*)
                    0.17%  189.99us       180  1.0550us     896ns  2.3680us  void kernelPointwiseApply2<CopyOp<int, long>, int, long, unsigned int, int=1, int=1>(OffsetInfo<long, int, long>, OffsetInfo<CopyOp<int, long>, int, unsigned int>, int, int)
                    0.17%  189.63us        90  2.1070us  1.8560us  2.2720us  void kernelPointwiseApply3<TensorDivOp<float>, float, float, float, unsigned int, int=1, int=1, int=2>(OffsetInfo<TensorDivOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.16%  178.11us       180     989ns     768ns  1.2800us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>(thrust::use_default, thrust::use_default)
                    0.16%  177.28us        90  1.9690us  1.7600us  2.1120us  void kernelPointwiseApply3<TensorDivOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorDivOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.15%  168.64us        80  2.1080us  1.6640us  2.2720us  void kernelPointwiseApply3<ELUupdateGradInput_functor<float>, float, float, float, unsigned int, int=1, int=1, int=2>(OffsetInfo<ELUupdateGradInput_functor<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.13%  141.86us        90  1.5760us  1.4400us  2.3040us  void kernelPointwiseApply3<TensorMulOp<float>, float, float, float, unsigned int, int=1, int=2, int=2>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=2>, float, float)
                    0.12%  134.98us        90  1.4990us  1.4080us  1.6960us  void kernelPointwiseApply3<LeakyReLUUpdateGradInput<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<LeakyReLUUpdateGradInput<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.11%  121.35us        90  1.3480us  1.2480us  1.4730us  void kernelPointwiseApply2<TensorAddOp<long>, long, long, unsigned int, int=1, int=1>(OffsetInfo<TensorAddOp<long>, long, unsigned int>, OffsetInfo<long, long, int=1>, long, long)
                    0.11%  120.48us        10  12.048us  11.808us  12.384us  sgemm_32x32x32_NT
                    0.10%  106.31us        90  1.1810us  1.1520us  1.3440us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__unique_by_key::InitAgent<thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*, int>, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, unsigned long, int*>(bool=1, thrust::cuda_cub::cub::ScanTileState<int, bool=1>, int*)
                    0.09%  103.11us        10  10.310us  10.049us  11.136us  void at::native::_GLOBAL__N__54_tmpxft_0000343e_00000000_10_SoftMax_compute_70_cpp1_ii_826a4626::cunn_SoftMaxBackward<int=2, float, float, at::native::_GLOBAL__N__54_tmpxft_0000343e_00000000_10_SoftMax_compute_70_cpp1_ii_826a4626::LogSoftMaxBackwardEpilogue>(float*, float, float, int)
                    0.04%  48.480us        10  4.8480us  4.6400us  5.1200us  void cunn_ClassNLLCriterion_updateGradInput_kernel<float>(float*, float*, long*, float*, float*, int, int, int, int, long)
                    0.02%  17.856us        10  1.7850us  1.7280us  2.0800us  void kernelPointwiseApply1<TensorFillOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorFillOp<float>, float, unsigned int>, float, float)
                    0.01%  15.841us        10  1.5840us  1.5040us  1.6960us  void kernelPointwiseApply3<ELUupdateGradInput_functor<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<ELUupdateGradInput_functor<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
      API calls:   98.25%  7.58643s      9260  819.27us  4.1910us  892.24ms  cudaLaunch
                    0.61%  46.878ms     75500     620ns     528ns  439.79us  cudaGetDevice
                    0.42%  32.189ms      1450  22.199us  5.5130us  495.54us  cudaMemcpyAsync
                    0.25%  19.323ms      1270  15.214us  1.4610us  671.41us  cudaStreamSynchronize
                    0.23%  17.882ms     28350     630ns     546ns  49.563us  cudaSetDevice
                    0.08%  5.7960ms      1010  5.7380us  5.2340us  17.152us  cudaFuncGetAttributes
                    0.07%  5.2702ms     56660      93ns      69ns  48.261us  cudaSetupArgument
                    0.05%  3.8274ms       470  8.1430us  4.1980us  22.433us  cudaMemsetAsync
                    0.02%  1.2587ms      9260     135ns      82ns  9.9470us  cudaConfigureCall
                    0.02%  1.1717ms      1940     603ns     525ns  9.8220us  cudaDeviceGetAttribute
                    0.01%  1.1519ms      8310     138ns      72ns  10.252us  cudaGetLastError
                    0.01%  704.19us      6680     105ns      67ns     577ns  cudaPeekAtLastError
==9588== Generated result file: /home/adam/school/research/gnn/gnn-research/pygat/profile/2019_03_05__19_18_00/train-timeline.9588.nvprof
