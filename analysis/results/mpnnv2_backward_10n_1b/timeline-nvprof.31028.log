==31028== NVPROF is profiling process 31028, command: python main.py --dataset qm9 --datasetPath ./data/qm9/dsgdb9nsd/ --epochs 2 --model MPNNv2 --log-interval 20 --profile-epoch-list 1 --profile-batch-list 100 --batch-size 10 --prefetch 10 --stop-after-profiling --prof-backprop --logPath ./log/2019_03_02__1
==31028== Profiling application: python main.py --dataset qm9 --datasetPath ./data/qm9/dsgdb9nsd/ --epochs 2 --model MPNNv2 --log-interval 20 --profile-epoch-list 1 --profile-batch-list 100 --batch-size 10 --prefetch 10 --stop-after-profiling --prof-backprop --logPath ./log/2019_03_02__1
==31028== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   16.70%  1.8582ms       326  5.6990us  2.8160us  9.0560us  sgemm_32x32x32_NN_vec
                   13.70%  1.5246ms       326  4.6760us  2.5280us  8.9600us  sgemm_32x32x32_TN_vec
                   13.53%  1.5053ms      1146  1.3130us     928ns  6.6880us  void kernelPointwiseApply3<TensorAddOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                   12.59%  1.4006ms       556  2.5190us  1.8240us  3.5840us  void kernelReduceNoncontigDim_shared<float, unsigned int, float, thrust::identity<float>, ReduceAdd<float>, thrust::identity<float>, int=1, int=1>(TensorInfo<float, unsigned int>, TensorInfo<float, unsigned int>, unsigned int, unsigned int, unsigned int, float, float, thrust::identity<float>, float, float volatile *, int*)
                   11.18%  1.2438ms       230  5.4070us  2.9760us  8.5120us  sgemm_32x32x32_TN
                    9.86%  1.0968ms       207  5.2980us  3.6800us  8.1920us  sgemm_32x32x32_NN
                    7.31%  813.00us       417  1.9490us  1.2480us  6.0800us  void kernelPointwiseApply3<ThresholdUpdateGradInput<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<ThresholdUpdateGradInput<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    3.25%  361.67us        69  5.2410us  5.1200us  5.5680us  void kernelPointwiseApply3<TensorMulOp<float>, float, float, float, unsigned int, int=1, int=-1, int=-1>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=-1>, float, float)
                    1.32%  146.69us        46  3.1880us  3.1360us  3.2960us  void kernelReduceNoncontigDim_shared<float, unsigned int, float, thrust::identity<float>, ReduceAdd<float>, thrust::identity<float>, int=1, int=2>(TensorInfo<float, unsigned int>, TensorInfo<float, unsigned int>, unsigned int, unsigned int, unsigned int, float, float, thrust::identity<float>, float, float volatile *, int*)
                    1.26%  140.48us       112  1.2540us     992ns  2.2720us  void kernelPointwiseApply1<TensorMulConstantOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorMulConstantOp<float>, float, unsigned int>, float, float)
                    1.20%  133.57us       112  1.1920us     896ns  1.4400us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=2, int=1>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    1.09%  121.25us       158     767ns     544ns  1.2480us  [CUDA memset]
                    1.01%  112.54us        56  2.0090us  1.2800us  3.0720us  void kernelPointwiseApply3<TensorAddCDivOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddCDivOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.85%  94.626us        69  1.3710us  1.3440us  1.4720us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=1, int=2>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.82%  91.713us        68  1.3480us  1.1200us  1.5040us  [CUDA memcpy DtoD]
                    0.70%  78.240us        56  1.3970us  1.0560us  2.6240us  void kernelPointwiseApply2<TensorAddOp<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.68%  75.681us        56  1.3510us     960ns  2.4960us  void kernelPointwiseApply2<TensorCAddOp<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<TensorCAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.63%  69.792us        46  1.5170us  1.3760us  7.0400us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=2, int=2>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.60%  67.264us        46  1.4620us  1.3760us  1.6000us  void kernelPointwiseApply3<TensorAddOp<float>, float, float, float, unsigned int, int=1, int=1, int=2>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.59%  65.922us        56  1.1770us     992ns  1.6640us  void kernelPointwiseApply2<Tensor_sqrt_Float_Op, float, float, unsigned int, int=1, int=1>(OffsetInfo<float, unsigned int, int=1>, OffsetInfo<float, unsigned int, int=1>, unsigned int, Tensor_sqrt_Float_Op)
                    0.56%  62.080us        56  1.1080us     928ns  1.5040us  void kernelPointwiseApply3<TensorAddCMulOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddCMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.51%  56.288us        56  1.0050us     928ns  1.1840us  void kernelPointwiseApply1<TensorAddConstantOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorAddConstantOp<float>, float, unsigned int>, float, float)
                    0.02%  2.7200us         1  2.7200us  2.7200us  2.7200us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=1, int=-1>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.01%  1.4400us         1  1.4400us  1.4400us  1.4400us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::binary_transform_f<thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor<float, float>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::binary_transform_f<thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor<float, float>, thrust::cuda_cub::__transform::always_true_predicate>, long>(thrust::device_ptr<float>, thrust::device_ptr<float>)
                    0.01%  1.2800us         1  1.2800us  1.2800us  1.2800us  void kernelPointwiseApply1<TensorFillOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorFillOp<float>, float, unsigned int>, float, float)
                    0.01%  1.2160us         1  1.2160us  1.2160us  1.2160us  [CUDA memcpy DtoH]
      API calls:   94.86%  1.00530s      4047  248.41us  4.9780us  976.84ms  cudaLaunch
                    3.01%  31.946ms     52932     603ns     527ns  302.17us  cudaGetDevice
                    1.48%  15.695ms     24843     631ns     544ns  11.018us  cudaSetDevice
                    0.34%  3.5665ms     31822     112ns      68ns  316.11us  cudaSetupArgument
                    0.09%  946.55us      4047     233ns     102ns  322.67us  cudaConfigureCall
                    0.08%  897.13us       227  3.9520us     527ns  12.611us  cudaMemsetAsync
                    0.07%  769.75us        69  11.155us  9.6440us  32.156us  cudaMemcpyAsync
                    0.06%  652.82us      4341     150ns      91ns  8.9250us  cudaGetLastError
                    0.00%  9.2000us         1  9.2000us  9.2000us  9.2000us  cudaFuncGetAttributes
                    0.00%  3.5200us         1  3.5200us  3.5200us  3.5200us  cudaStreamSynchronize
                    0.00%  1.6470us         1  1.6470us  1.6470us  1.6470us  cudaDeviceGetAttribute
                    0.00%     270ns         2     135ns      71ns     199ns  cudaPeekAtLastError
==31028== Generated result file: /home/adam/school/research/gnn/gnn-research/mpnn/profile/2019_03_02__16_53_05/train-timeline.31028.nvprof
