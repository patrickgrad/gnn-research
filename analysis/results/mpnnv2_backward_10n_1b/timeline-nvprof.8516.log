==8516== NVPROF is profiling process 8516, command: python main.py --dataset qm9 --datasetPath ./data/qm9/dsgdb9nsd/ --epochs 1 --model MPNNv2 --log-interval 20 --profile-epoch-list 0 --profile-batch-list 100 --batch-size 10 --prefetch 10 --stop-after-profiling --prof-backprop --logPath ./log/2019_03_10__1
==8516== Profiling application: python main.py --dataset qm9 --datasetPath ./data/qm9/dsgdb9nsd/ --epochs 1 --model MPNNv2 --log-interval 20 --profile-epoch-list 0 --profile-batch-list 100 --batch-size 10 --prefetch 10 --stop-after-profiling --prof-backprop --logPath ./log/2019_03_10__1
==8516== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   15.60%  1.5281ms       298  5.1270us  2.8160us  7.1680us  sgemm_32x32x32_NN_vec
                   14.03%  1.3744ms      1042  1.3190us     928ns  2.3040us  void kernelPointwiseApply3<TensorAddOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                   13.49%  1.3217ms       298  4.4350us  2.5600us  7.2640us  sgemm_32x32x32_TN_vec
                   12.82%  1.2556ms       508  2.4710us  1.8560us  3.4880us  void kernelReduceNoncontigDim_shared<float, unsigned int, float, thrust::identity<float>, ReduceAdd<float>, thrust::identity<float>, int=1, int=1>(TensorInfo<float, unsigned int>, TensorInfo<float, unsigned int>, unsigned int, unsigned int, unsigned int, float, float, thrust::identity<float>, float, float volatile *, int*)
                   11.13%  1.0905ms       210  5.1930us  2.8800us  8.0960us  sgemm_32x32x32_TN
                    9.90%  970.38us       189  5.1340us  3.6160us  8.3840us  sgemm_32x32x32_NN
                    7.35%  720.29us       381  1.8900us  1.2480us  3.7440us  void kernelPointwiseApply3<ThresholdUpdateGradInput<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<ThresholdUpdateGradInput<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    3.08%  301.54us        63  4.7860us  4.6080us  5.1200us  void kernelPointwiseApply3<TensorMulOp<float>, float, float, float, unsigned int, int=1, int=-1, int=-1>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=-1>, float, float)
                    1.43%  140.51us       112  1.2540us     992ns  2.3360us  void kernelPointwiseApply1<TensorMulConstantOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorMulConstantOp<float>, float, unsigned int>, float, float)
                    1.39%  136.29us        42  3.2440us  3.0400us  3.4240us  void kernelReduceNoncontigDim_shared<float, unsigned int, float, thrust::identity<float>, ReduceAdd<float>, thrust::identity<float>, int=1, int=2>(TensorInfo<float, unsigned int>, TensorInfo<float, unsigned int>, unsigned int, unsigned int, unsigned int, float, float, thrust::identity<float>, float, float volatile *, int*)
                    1.24%  121.76us       102  1.1930us     896ns  1.4720us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=2, int=1>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    1.10%  107.52us       144     746ns     544ns  1.0560us  [CUDA memset]
                    0.98%  96.065us        56  1.7150us  1.2800us  2.4960us  void kernelPointwiseApply3<TensorAddCDivOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddCDivOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.88%  86.144us        63  1.3670us  1.3120us  1.5040us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=1, int=2>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.84%  82.272us        62  1.3260us  1.1200us  1.4720us  [CUDA memcpy DtoD]
                    0.80%  78.144us        56  1.3950us  1.0560us  2.4320us  void kernelPointwiseApply2<TensorAddOp<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.77%  74.976us        56  1.3380us     928ns  2.4000us  void kernelPointwiseApply2<TensorCAddOp<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<TensorCAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.69%  67.873us        56  1.2120us  1.0240us  1.5360us  void kernelPointwiseApply2<Tensor_sqrt_Float_Op, float, float, unsigned int, int=1, int=1>(OffsetInfo<float, unsigned int, int=1>, OffsetInfo<float, unsigned int, int=1>, unsigned int, Tensor_sqrt_Float_Op)
                    0.62%  60.897us        56  1.0870us     896ns  1.4720us  void kernelPointwiseApply3<TensorAddCMulOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddCMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.61%  59.969us        42  1.4270us  1.2800us  1.5680us  void kernelPointwiseApply3<TensorAddOp<float>, float, float, float, unsigned int, int=1, int=1, int=2>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.59%  58.176us        42  1.3850us  1.3440us  1.4720us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=2, int=2>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.58%  56.672us        56  1.0120us     928ns  1.2160us  void kernelPointwiseApply1<TensorAddConstantOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorAddConstantOp<float>, float, unsigned int>, float, float)
                    0.03%  3.2640us         1  3.2640us  3.2640us  3.2640us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=1, int=-1>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.01%  1.4400us         1  1.4400us  1.4400us  1.4400us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::binary_transform_f<thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor<float, float>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::binary_transform_f<thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor<float, float>, thrust::cuda_cub::__transform::always_true_predicate>, long>(thrust::device_ptr<float>, thrust::device_ptr<float>)
                    0.01%  1.2800us         1  1.2800us  1.2800us  1.2800us  void kernelPointwiseApply1<TensorFillOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorFillOp<float>, float, unsigned int>, float, float)
                    0.01%  1.2160us         1  1.2160us  1.2160us  1.2160us  [CUDA memcpy DtoH]
      API calls:   95.22%  954.24ms      3731  255.76us  5.4240us  927.97ms  cudaLaunch
                    2.81%  28.160ms     48490     580ns     528ns  245.41us  cudaGetDevice
                    1.37%  13.754ms     22763     604ns     544ns  13.189us  cudaSetDevice
                    0.34%  3.3600ms     29198     115ns      70ns  240.77us  cudaSetupArgument
                    0.08%  793.41us       207  3.8320us     527ns  14.599us  cudaMemsetAsync
                    0.07%  710.04us        63  11.270us  10.230us  33.067us  cudaMemcpyAsync
                    0.06%  601.22us      3731     161ns     124ns  3.8310us  cudaConfigureCall
                    0.05%  540.91us      3999     135ns      88ns  12.772us  cudaGetLastError
                    0.00%  9.9940us         1  9.9940us  9.9940us  9.9940us  cudaFuncGetAttributes
                    0.00%  4.1010us         1  4.1010us  4.1010us  4.1010us  cudaStreamSynchronize
                    0.00%  1.2430us         1  1.2430us  1.2430us  1.2430us  cudaDeviceGetAttribute
                    0.00%     315ns         2     157ns      72ns     243ns  cudaPeekAtLastError
==8516== Generated result file: /home/adam/school/research/gnn/gnn-research/mpnn/profile/2019_03_10__13_11_04/train-timeline.8516.nvprof
