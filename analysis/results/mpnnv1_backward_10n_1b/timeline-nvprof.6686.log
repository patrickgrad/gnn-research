==6686== NVPROF is profiling process 6686, command: python main.py --dataset qm9 --datasetPath ./data/qm9/dsgdb9nsd/ --epochs 2 --model MPNNv1 --log-interval 20 --profile-epoch-list 1 --profile-batch-list 100 --batch-size 10 --prefetch 10 --stop-after-profiling --prof-backprop --logPath ./log/2019_03_02__2
==6686== Profiling application: python main.py --dataset qm9 --datasetPath ./data/qm9/dsgdb9nsd/ --epochs 2 --model MPNNv1 --log-interval 20 --profile-epoch-list 1 --profile-batch-list 100 --batch-size 10 --prefetch 10 --stop-after-profiling --prof-backprop --logPath ./log/2019_03_02__2
==6686== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   25.61%  4.6026ms         8  575.32us  26.528us  1.1224ms  maxwell_sgemm_128x64_nn
                   22.94%  4.1223ms        26  158.55us  4.2240us  1.3360ms  sgemm_32x32x32_NN
                   22.68%  4.0754ms        19  214.49us  3.7120us  1.3258ms  sgemm_32x32x32_TN
                    9.34%  1.6783ms         3  559.43us  553.00us  563.01us  void kernelReduceNoncontigDim<float, unsigned int, float, thrust::identity<float>, ReduceAdd<float>, thrust::identity<float>, int=1, int=1>(TensorInfo<float, unsigned int>, TensorInfo<float, unsigned int>, unsigned int, unsigned int, unsigned int, float, float, thrust::identity<float>, float)
                    3.19%  573.44us        66  8.6880us  2.4000us  68.961us  sgemm_32x32x32_TN_vec
                    2.45%  439.81us        69  6.3740us  1.1200us  55.713us  void kernelPointwiseApply3<ThresholdUpdateGradInput<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<ThresholdUpdateGradInput<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    2.44%  438.63us        63  6.9620us  2.8800us  71.169us  sgemm_32x32x32_NN_vec
                    1.83%  329.28us        89  3.6990us  1.7600us  31.200us  void kernelReduceNoncontigDim_shared<float, unsigned int, float, thrust::identity<float>, ReduceAdd<float>, thrust::identity<float>, int=1, int=1>(TensorInfo<float, unsigned int>, TensorInfo<float, unsigned int>, unsigned int, unsigned int, unsigned int, float, float, thrust::identity<float>, float, float volatile *, int*)
                    1.72%  309.64us       189  1.6380us     832ns  35.809us  void kernelPointwiseApply3<TensorAddOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    1.09%  195.75us         3  65.248us  64.225us  65.920us  sgemm_128x128x8_NN_vec
                    0.76%  136.93us         3  45.643us  45.441us  46.049us  void sgemm_largek_lds64<bool=0, bool=1, int=5, int=5, int=4, int=4, int=4, int=32>(float*, float const *, float const *, int, int, int, int, int, int, float const *, float const *, float, float, int, int, int*, int*)
                    0.65%  117.15us        56  2.0920us     896ns  27.616us  void kernelPointwiseApply1<TensorMulConstantOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorMulConstantOp<float>, float, unsigned int>, float, float)
                    0.57%  102.21us        28  3.6500us  1.1200us  55.872us  void kernelPointwiseApply3<TensorAddCDivOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddCDivOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.51%  92.449us         7  13.207us  12.032us  13.760us  maxwell_sgemm_64x64_nt
                    0.43%  77.027us        28  2.7500us     832ns  42.465us  void kernelPointwiseApply2<TensorCAddOp<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<TensorCAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.42%  75.584us        28  2.6990us     960ns  40.736us  void kernelPointwiseApply2<TensorAddOp<float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, float, float)
                    0.40%  72.320us         3  24.106us  23.200us  24.640us  maxwell_sgemm_128x64_nt
                    0.38%  68.832us        28  2.4580us     832ns  42.240us  void kernelPointwiseApply3<TensorAddCMulOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddCMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.37%  66.816us         2  33.408us  33.120us  33.696us  void kernelReduceContigDim<float, unsigned int, float, thrust::identity<float>, ReduceAdd<float>, thrust::identity<float>, int=1, int=1>(TensorInfo<float, unsigned int>, TensorInfo<float, unsigned int>, unsigned int, unsigned int, float, float, thrust::identity<float>, float)
                    0.33%  59.297us        28  2.1170us     896ns  28.705us  void kernelPointwiseApply2<Tensor_sqrt_Float_Op, float, float, unsigned int, int=1, int=1>(OffsetInfo<float, unsigned int, int=1>, OffsetInfo<float, unsigned int, int=1>, unsigned int, Tensor_sqrt_Float_Op)
                    0.32%  57.760us         3  19.253us  19.200us  19.328us  void kernelPointwiseApply3<TensorMulOp<float>, float, float, float, unsigned int, int=1, int=-1, int=2>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=-1>, float, float)
                    0.30%  54.528us        51  1.0690us     768ns  3.2640us  [CUDA memcpy DtoD]
                    0.30%  53.984us        28  1.9280us     800ns  29.184us  void kernelPointwiseApply1<TensorAddConstantOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorAddConstantOp<float>, float, unsigned int>, float, float)
                    0.23%  42.016us        56     750ns     448ns  5.1840us  [CUDA memset]
                    0.18%  32.960us         6  5.4930us  3.4560us  7.2960us  void elementWise_bp2<float, float, float, int=3, int=6, bool=0>(int, int, float*, float*)
                    0.16%  29.152us        23  1.2670us     928ns  2.7200us  void kernelPointwiseApply3<TensorMulOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.08%  14.752us         3  4.9170us  4.7360us  5.2480us  void GRU_elementWise_bp1<float, float, float>(int, int, float*, float*, float*, float*, float*, float*, float*, int, int)
                    0.07%  13.152us        10  1.3150us  1.1200us  1.4400us  void kernelPointwiseApply3<TensorMulOp<float>, float, float, float, unsigned int, int=1, int=2, int=1>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=2>, float, float)
                    0.07%  12.288us        10  1.2280us  1.0880us  1.3440us  void kernelPointwiseApply3<sigmoid_updateGradInput_functor<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<sigmoid_updateGradInput_functor<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    0.06%  11.169us        10  1.1160us  1.0560us  1.2170us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=1, int=2>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.04%  7.4560us         3  2.4850us     512ns  3.5200us  [CUDA memcpy HtoD]
                    0.03%  4.9920us         3  1.6640us  1.6640us  1.6640us  void scal_kernel<float, float, int=1, bool=1, int=6, int=5, int=5, int=3>(cublasTransposeParams<float>, float const *, float*, float const *)
                    0.01%  1.3120us         1  1.3120us  1.3120us  1.3120us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::binary_transform_f<thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor<float, float>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::binary_transform_f<thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::device_ptr<float>, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor<float, float>, thrust::cuda_cub::__transform::always_true_predicate>, long>(thrust::device_ptr<float>, thrust::device_ptr<float>)
                    0.01%  1.2160us         1  1.2160us  1.2160us  1.2160us  void kernelPointwiseApply1<TensorFillOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorFillOp<float>, float, unsigned int>, float, float)
                    0.01%  1.1520us         1  1.1520us  1.1520us  1.1520us  [CUDA memcpy DtoH]
      API calls:   50.26%  1.10229s       844  1.3060ms  4.9190us  1.09483s  cudaLaunch
                   49.12%  1.07724s        37  29.115ms     650ns  1.07722s  cudaEventDestroy
                    0.33%  7.2317ms      9953     726ns     542ns  10.560us  cudaGetDevice
                    0.17%  3.8314ms      4533     845ns     554ns  305.30us  cudaSetDevice
                    0.04%  849.79us      6308     134ns      70ns  3.8900us  cudaSetupArgument
                    0.03%  695.03us        55  12.636us  7.1000us  37.364us  cudaMemcpyAsync
                    0.02%  474.14us        56  8.4660us  2.2670us  18.878us  cudaMemsetAsync
                    0.01%  174.78us       952     183ns      75ns  3.8150us  cudaGetLastError
                    0.01%  166.18us       844     196ns     109ns  2.7270us  cudaConfigureCall
                    0.00%  82.098us        24  3.4200us  1.8840us  9.1880us  cudaStreamDestroy
                    0.00%  47.325us        15  3.1550us  1.5920us  9.5630us  cudaStreamCreateWithPriority
                    0.00%  45.277us        39  1.1600us     843ns  3.1350us  cudaEventCreateWithFlags
                    0.00%  37.165us         9  4.1290us  1.6440us  9.9750us  cudaStreamCreate
                    0.00%  35.866us        33  1.0860us     740ns  1.8430us  cudaStreamWaitEvent
                    0.00%  33.260us        27  1.2310us     903ns  2.4110us  cudaEventRecord
                    0.00%  14.612us         4  3.6530us  1.8450us  8.1210us  cudaEventQuery
                    0.00%  11.543us         1  11.543us  11.543us  11.543us  cudaFuncGetAttributes
                    0.00%  4.9390us         1  4.9390us  4.9390us  4.9390us  cudaStreamSynchronize
                    0.00%  1.3630us         1  1.3630us  1.3630us  1.3630us  cudaDeviceGetAttribute
                    0.00%     461ns         2     230ns     132ns     329ns  cudaPeekAtLastError
==6686== Generated result file: /home/adam/school/research/gnn/gnn-research/mpnn/profile/2019_03_02__21_41_47/train-timeline.6686.nvprof
